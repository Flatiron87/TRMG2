<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Caliper Corporation" />

<meta name="date" content="2021-03-02" />

<title>Resident Production Model</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="site_libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="site_libs/anchor-sections-1.0/anchor-sections.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>




<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">TRMG2</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Databases
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="tazs_and_se_data.html">TAZs and SE Data</a>
    </li>
    <li>
      <a href="networks.html">Networks</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Surveys
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="survey_processing.html">Household Survey</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Resident Models
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="population_synthesis.html">Synthesis</a>
    </li>
    <li>
      <a href="auto_ownership.html">Auto Ownership</a>
    </li>
    <li>
      <a href="resident_production.html">Production</a>
    </li>
    <li>
      <a href="time_of_day.html">Time of Day</a>
    </li>
    <li>
      <a href="resident_nonmotorized.html">Non-motorized</a>
    </li>
    <li>
      <a href="nhb.html">Non-homebased</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other Models
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="accessibility.html">Accessibility</a>
    </li>
    <li>
      <a href="airport.html">Airport</a>
    </li>
    <li>
      <a href="commercial_vehicles.html">Commercial Vehicles</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Resident Production Model</h1>
<h4 class="author">Caliper Corporation</h4>
<h4 class="date">March 2, 2021</h4>

</div>


<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>The goal of the resident trip production models in TRMG2 is to determine how many trips each individual will make in a day. Unlike traditional trip generation models, attractions are not estimated in this step. Instead, the destination choice models estimate coefficients on employment as part of the size term, which function similar to trip attractions.</p>
<p>TRMG2 productions models are person-level models. This means that detailed information about each person (e.g. age), as well as the characteristics of their household and geographic location, are available to improve prediction making.</p>
</div>
<div id="using-dt-to-guide-segmentation" class="section level2">
<h2>Using DT to guide segmentation</h2>
<p>After attempting various forms of generalized linear models (GLM) and logistic regression models, Caliper opted to use decision trees from the machine learning stack. This model form had much stronger predictive power compared to traditional approaches while still being easy to understand and explain.</p>
<p>In the trees below, each node lists the average trip rate as well as the percent of the population that node represents. This lets you see the overall average trip rate (top of the tree) and how it changes as you segment the surveyed population.</p>
<p>To save room in the charts, many of the explanatory variables are abbreviated. Their meanings are listed below for reference:</p>
<ul>
<li>Person-level variables
<ul>
<li>is_worker: if the person is a worker</li>
<li>is_senior: if the person is &gt;= 65</li>
<li>is_child: if the person is &lt; 18</li>
<li>age: person’s age</li>
<li>gender: Male (1) and Female (2)</li>
<li>single_parent: if the person is the only adult in a household with children</li>
</ul></li>
<li>Household Variables
<ul>
<li>retired_hh: if the household contains only retirees</li>
<li>per_inc: per-capita income (household income / size)</li>
<li>oth_ppl: number of other people in the household</li>
<li>oth_kids: number of other kids in the household</li>
</ul></li>
<li>Zonal variables
<ul>
<li>g_access: general accessibility of the person’s home zone</li>
<li>n_access: nearby accessibility of the person’s home zone</li>
<li>e_access: employment accessibility of the person’s home zone</li>
</ul></li>
</ul>
</div>
<div id="work-tours" class="section level2">
<h2>Work Tours</h2>
<div id="w_hb_w_all" class="section level3">
<h3>W_HB_W_All</h3>
<p>These are the traditional HBW (home-based work) trips. Unsuprisingly, the most important factor is whether or not the individual is a worker. After that, the person’s age and living arrangements best predict trip rate.</p>
<p><img src="resident_production_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>R-squared: 0.364</p>
</div>
<div id="w_hb_o_all" class="section level3">
<h3>W_HB_O_All</h3>
<p>When someone makes a stop on their way to or from work, they are making a homebased other trip on a work tour. Work status is the most important predictor followed by age. Unlike W_HB_W trips, accessibility of the home zone also plays a role in determining the frequency of these extra stops. In the bottom right of the tree, workers that live in areas with lower accessibility make more of these intermediate stops on work tours. This is the expected behavior. People living in rural areas are more likely to make these extra stops while out on work tours.</p>
<p><img src="resident_production_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>R-squared: 0.156</p>
</div>
<div id="w_hb_ek12_all" class="section level3">
<h3>W_HB_EK12_All</h3>
<p>This trip type describes adults who drop off children on the way to work or pick them up on the way home (school escort trips). Having children and being a worker are both required to qualify to make this trip, and they show up as the most important questions in the decision tree. Finally, the age of the adult plays a small role in determining final trip rates.</p>
<p><img src="resident_production_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>R-squared: 0.183</p>
</div>
</div>
<div id="non-work-tours" class="section level2">
<h2>Non-Work Tours</h2>
<div id="n_hb_k12_all" class="section level3">
<h3>N_HB_K12_All</h3>
<p>This trip type is made by two types of people:</p>
<ul>
<li>Students traveling to school</li>
<li>Parents taking their kids to school (not on a work tour)</li>
</ul>
<p>The decision tree model recognizes this basic structure in the data and uses age to split people into these two groups. For adults (left side of the tree), having kids is required to make this trip. Their work status and age further refine their trip rate. For children (right side of the tree), age is the primary factor. Children under 5 do not attend K12, but they do make these trips if they have older siblings.</p>
<p><img src="resident_production_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>R-squared: 0.534</p>
</div>
<div id="n_hb_ome_all" class="section level3">
<h3>N_HB_OME_All</h3>
<p>This trip type captures shopping, dining, and maintenance activities. These are trips where the primary purpose includes spending money. These trips are harder to predict based on the data collected in the survey, and this results in lower r-squared values. Nonetheless, factors like age, accessibility, work status, and income do help to differentiate trip rates.</p>
<p><img src="resident_production_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>R-squared: 0.102</p>
</div>
<div id="n_hb_od_long" class="section level3">
<h3>N_HB_OD_Long</h3>
<p>These are other, discretionary trips with a long duration time (over 30 minutes). A common example is visiting the home of friends or family. Work status, age, and accessibility are the primary factors used to differentiate trip rates.</p>
<p><img src="resident_production_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>R-squared: 0.145</p>
</div>
<div id="n_hb_od_short" class="section level3">
<h3>N_HB_OD_Short</h3>
<p>These are other, discretionary trips with a short activity duration. These are similar to N_HB_OD_Long, and include things like trips to a friend’s house, church, or other locations. Like other discretionary tours, the low r-squared indicates some difficulty in making predictions. However, of the variables available, accessibility, age, income, and children in the household contribute the most to differences in trip making.</p>
<p><img src="resident_production_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>R-squared: 0.101</p>
</div>
<div id="n_hb_omed_all" class="section level3">
<h3>N_HB_OMED_All</h3>
<p>These are medical trips, and as a result, retirement and age play an important role in predicting trip rates. This trip type has the poorest r-squared regardless of model form used. The survey EDA shows that other aspects of this trip type are unique enough to keep it separated - even this model simply applied the total average trip rate of 0.066 trips to every person. This model is a small improvement on that.</p>
<p><img src="resident_production_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>R-squared: 0.027</p>
</div>
</div>
<div id="calibration" class="section level2">
<h2>Calibration</h2>
<p>The table below shows the production model results compared back to the total trips in the survey. Overall, the model performs extremely well even without calibration.</p>
<p><em>TODO: These results are close enough that we are not going to adjust them unless we need to for validation. We will revisit this section then if needed.</em></p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Trip Type
</th>
<th style="text-align:right;">
Observed
</th>
<th style="text-align:right;">
Modelled
</th>
<th style="text-align:right;">
Difference
</th>
<th style="text-align:right;">
%Difference
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
N_HB_K12_All
</td>
<td style="text-align:right;">
577,069
</td>
<td style="text-align:right;">
569,133
</td>
<td style="text-align:right;">
-7,936
</td>
<td style="text-align:right;">
-1
</td>
</tr>
<tr>
<td style="text-align:left;">
N_HB_OD_Long
</td>
<td style="text-align:right;">
894,211
</td>
<td style="text-align:right;">
920,221
</td>
<td style="text-align:right;">
26,009
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
N_HB_OD_Short
</td>
<td style="text-align:right;">
726,812
</td>
<td style="text-align:right;">
709,869
</td>
<td style="text-align:right;">
-16,943
</td>
<td style="text-align:right;">
-2
</td>
</tr>
<tr>
<td style="text-align:left;">
N_HB_OME_All
</td>
<td style="text-align:right;">
1,022,986
</td>
<td style="text-align:right;">
987,549
</td>
<td style="text-align:right;">
-35,437
</td>
<td style="text-align:right;">
-4
</td>
</tr>
<tr>
<td style="text-align:left;">
N_HB_OMED_All
</td>
<td style="text-align:right;">
113,515
</td>
<td style="text-align:right;">
100,922
</td>
<td style="text-align:right;">
-12,593
</td>
<td style="text-align:right;">
-11
</td>
</tr>
<tr>
<td style="text-align:left;">
W_HB_EK12_All
</td>
<td style="text-align:right;">
57,304
</td>
<td style="text-align:right;">
57,663
</td>
<td style="text-align:right;">
360
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
W_HB_O_All
</td>
<td style="text-align:right;">
287,277
</td>
<td style="text-align:right;">
289,502
</td>
<td style="text-align:right;">
2,225
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
W_HB_W_All
</td>
<td style="text-align:right;">
766,618
</td>
<td style="text-align:right;">
787,745
</td>
<td style="text-align:right;">
21,127
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
Total
</td>
<td style="text-align:right;">
4,445,792
</td>
<td style="text-align:right;">
4,422,603
</td>
<td style="text-align:right;">
-23,189
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
</div>

<br>
<br>
<br>
<hr>
<p><a href="https://www.caliper.com/">Caliper Corporation</a>, 2021</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>


</body>
</html>
