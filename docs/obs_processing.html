<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Caliper Corporation" />

<meta name="date" content="2021-03-15" />

<title>On-board Survey Processing</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="site_libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="site_libs/anchor-sections-1.0/anchor-sections.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>




<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">TRMG2</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Databases
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="tazs_and_se_data.html">TAZs and SE Data</a>
    </li>
    <li>
      <a href="networks.html">Networks</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Surveys
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="survey_processing.html">Household Survey</a>
    </li>
    <li>
      <a href="obs_processing.html">On-Board Survey</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Resident Models
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="population_synthesis.html">Synthesis</a>
    </li>
    <li>
      <a href="auto_ownership.html">Auto Ownership</a>
    </li>
    <li>
      <a href="resident_production.html">Production</a>
    </li>
    <li>
      <a href="time_of_day.html">Time of Day</a>
    </li>
    <li>
      <a href="resident_nonmotorized.html">Non-motorized</a>
    </li>
    <li>
      <a href="nhb.html">Non-homebased</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other Models
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="accessibility.html">Accessibility</a>
    </li>
    <li>
      <a href="airport.html">Airport</a>
    </li>
    <li>
      <a href="commercial_vehicles.html">Commercial Vehicles</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">On-board Survey Processing</h1>
<h4 class="author">Caliper Corporation</h4>
<h4 class="date">March 15, 2021</h4>

</div>


<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>On-board surveys ask transit riders a series of question while they are on the bus in order to obtain detailed information about demographics, trip purpose, modes used, and other variables. These targeted surveys are critical for understanding transit users in the region. Due to the small size of the transit market in the Triangle and the small household survey sample size, the household survey does not contain enough transit trips to estimate the behavior of these travelers.</p>
<p>In the Triangle, a survey of GoTriangle and DCHC transit was conducted in 2014 (excluding Duke Transit). CAMPO agencies were surveyed in 2015 along with new GoTriangle routes. These are used to gain insight into the transit market.</p>
</div>
<div id="combining-surveys" class="section level2">
<h2>Combining surveys</h2>
<p>Unlike the household surveys, the transit surveys were collected by different companies. Combining the surveys required translating the different field codes from each into a combined set of values. The surveys collected the same basic information, which made this process easier. Additionally, because different routes were collected in each survey, no routes were double counted and no adjustments to the sample weights were needed.</p>
</div>
<div id="geocoding" class="section level2">
<h2>Geocoding</h2>
<p>As with the household survey, the transit trip latitude/longitude values were translated into TRMG2 TAZs. For a transit trip, this includes the home, origin, destination, boarding, and alighting locations. A sample of this is shown in the table below:</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
route
</th>
<th style="text-align:right;">
weight
</th>
<th style="text-align:right;">
home_taz
</th>
<th style="text-align:right;">
orig_taz
</th>
<th style="text-align:right;">
board_taz
</th>
<th style="text-align:right;">
alight_taz
</th>
<th style="text-align:right;">
dest_taz
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Route 2: Falls of Neuse- INBOUND toward Downtown
</td>
<td style="text-align:right;">
6.76
</td>
<td style="text-align:right;">
1448
</td>
<td style="text-align:right;">
2651
</td>
<td style="text-align:right;">
2542
</td>
<td style="text-align:right;">
1429
</td>
<td style="text-align:right;">
1935
</td>
</tr>
<tr>
<td style="text-align:left;">
Route 1: Capital- OUTBOUND toward Triangle Town Center
</td>
<td style="text-align:right;">
7.45
</td>
<td style="text-align:right;">
1781
</td>
<td style="text-align:right;">
1435
</td>
<td style="text-align:right;">
1429
</td>
<td style="text-align:right;">
1446
</td>
<td style="text-align:right;">
1448
</td>
</tr>
<tr>
<td style="text-align:left;">
Route 2: Falls of Neuse- INBOUND toward Downtown
</td>
<td style="text-align:right;">
6.76
</td>
<td style="text-align:right;">
1467
</td>
<td style="text-align:right;">
1700
</td>
<td style="text-align:right;">
1699
</td>
<td style="text-align:right;">
1429
</td>
<td style="text-align:right;">
1467
</td>
</tr>
<tr>
<td style="text-align:left;">
C-Tran: Route 2: COUNTERCLOCKWISE
</td>
<td style="text-align:right;">
2.83
</td>
<td style="text-align:right;">
1892
</td>
<td style="text-align:right;">
1892
</td>
<td style="text-align:right;">
1874
</td>
<td style="text-align:right;">
2209
</td>
<td style="text-align:right;">
2209
</td>
</tr>
<tr>
<td style="text-align:left;">
C-Tran: Route 4: OUTBOUND toward NC Hwy 55
</td>
<td style="text-align:right;">
2.73
</td>
<td style="text-align:right;">
2339
</td>
<td style="text-align:right;">
2335
</td>
<td style="text-align:right;">
2269
</td>
<td style="text-align:right;">
2326
</td>
<td style="text-align:right;">
2339
</td>
</tr>
<tr>
<td style="text-align:left;">
C-Tran: Route 5: INBOUND toward Train Station
</td>
<td style="text-align:right;">
2.45
</td>
<td style="text-align:right;">
1646
</td>
<td style="text-align:right;">
2180
</td>
<td style="text-align:right;">
2180
</td>
<td style="text-align:right;">
2269
</td>
<td style="text-align:right;">
1646
</td>
</tr>
</tbody>
</table>
</div>
<div id="reasonableness-checks" class="section level2 tabset">
<h2>Reasonableness checks</h2>
<p>A high level review of the combined survey was performed to make sure processing had not introduced errors. Some of those checks are shown in the charts below. All dimensions checked looked reasonable.</p>
<div id="agency" class="section level3">
<h3>Agency</h3>
<p><img src="obs_processing_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
</div>
<div id="time-of-day" class="section level3">
<h3>Time of Day</h3>
<p><img src="obs_processing_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="access-mode" class="section level3">
<h3>Access Mode</h3>
<p><img src="obs_processing_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
<div id="fare-type" class="section level3">
<h3>Fare Type</h3>
<p><img src="obs_processing_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
</div>
</div>
<div id="survey-assignment" class="section level2">
<h2>Survey Assignment</h2>
<p>For an additional check on both the on-board survey processing and the model’s route network, the on-board survey was assigned. This involved processing the survey into the appropriate matrices by time of day, transit mode, and accesss mode. The model assignment macros in TransCAD were used to assign these to the route system, and the results were compared to reported ridership by route.</p>
<p>The percent root mean square error (%RMSE) for route-level boardings was 96.8%. The agency-level %RMSE was 52.63%. The table below shows the agency-level comparison.</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Agency
</th>
<th style="text-align:right;">
Observed
</th>
<th style="text-align:right;">
Modelled
</th>
<th style="text-align:right;">
Difference
</th>
<th style="text-align:right;">
Absolute Difference
</th>
<th style="text-align:right;">
Percent Difference
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
CAT
</td>
<td style="text-align:right;">
23,218
</td>
<td style="text-align:right;">
39,299
</td>
<td style="text-align:right;">
16,081
</td>
<td style="text-align:right;">
16,081
</td>
<td style="text-align:right;">
69.26
</td>
</tr>
<tr>
<td style="text-align:left;">
CHT
</td>
<td style="text-align:right;">
26,371
</td>
<td style="text-align:right;">
21,407
</td>
<td style="text-align:right;">
-4,964
</td>
<td style="text-align:right;">
4,964
</td>
<td style="text-align:right;">
-18.82
</td>
</tr>
<tr>
<td style="text-align:left;">
CTRAN
</td>
<td style="text-align:right;">
1,003
</td>
<td style="text-align:right;">
1,805
</td>
<td style="text-align:right;">
802
</td>
<td style="text-align:right;">
802
</td>
<td style="text-align:right;">
79.96
</td>
</tr>
<tr>
<td style="text-align:left;">
DATA
</td>
<td style="text-align:right;">
21,601
</td>
<td style="text-align:right;">
24,554
</td>
<td style="text-align:right;">
2,953
</td>
<td style="text-align:right;">
2,953
</td>
<td style="text-align:right;">
13.67
</td>
</tr>
<tr>
<td style="text-align:left;">
NCSU
</td>
<td style="text-align:right;">
16,699
</td>
<td style="text-align:right;">
18,255
</td>
<td style="text-align:right;">
1,556
</td>
<td style="text-align:right;">
1,556
</td>
<td style="text-align:right;">
9.32
</td>
</tr>
<tr>
<td style="text-align:left;">
TT
</td>
<td style="text-align:right;">
9,184
</td>
<td style="text-align:right;">
15,399
</td>
<td style="text-align:right;">
6,215
</td>
<td style="text-align:right;">
6,215
</td>
<td style="text-align:right;">
67.67
</td>
</tr>
</tbody>
</table>
<p>These differences are large, but manual path checking did not uncover any errors. This test assignment was performed on a network with a rough initial guess of travel times, which likely contributed to these differences. More attention will be paid to agency- and route-level ridership comparisons during model validation. It may be that fares or other route attributes received from stakeholders need to be adjusted. One positive result of this early test was that all routes received ridership, which indicates no critical accessibility flaws in the network.</p>
<p><em>TODO: Revise this section after validation</em></p>
</div>

<br>
<br>
<br>
<hr>
<p><a href="https://www.caliper.com/">Caliper Corporation</a>, 2021</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>


</body>
</html>
